{% extends base %}

{% block postamble %}
<!-- <link rel="stylesheet" href="modal.css"> -->
<style>
    /* https://codepen.io/KanatSahanov/pen/raGXXa */

@import "compass/css3";

.modal{
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  z-index: 20;
  padding: 30px;
  width:  100%;
  height: 100%;
  margin: 0;
  padding: 0;
  opacity: 0;
  visibility: hidden;
  transition:visibility 0s linear 0.1s,opacity 0.3s ease;

  &.open{
    visibility:visible;
    opacity: 1;
    transition-delay:0s;
  }

  &__overlay{
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
    z-index: 21;
    background-color: rgba(0,0,0,0.7);
  }

  &__close{
    position: absolute;
    top: 10px;
    right: 10px;
    border: none;
    outline: none;
    background: none;
    font-size: 24px;
    color: #747474;
    font-weight: bold;

    &:hover{
      color: #000;
    }
  }

  &__container{
    position: relative;
    z-index: 22;
    width: 400px;
    height: 200px;
    top: 50%;
    transform: translateY(-50%);
    box-shadow:  0 0 10px #fff;
    margin: 0 auto;
    padding: 30px;
    background-color: #fff;
    text-align: center;
  }
}
</style>
<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
<!-- <script src="modal.js"></script> -->
  <script type="text/javascript">
  function openModal(message) {
      var modalTrigger = document.getElementsByClassName('modal_overlay');

      /* Set onclick event handler for all trigger elements */
      for(var i = 0; i < modalTrigger.length; i++) {
          modalTrigger[i].style.visibility = "visible";
          modalTrigger[i].innerHTML = message;
      }
  }
  function closeModal() {
      var modalTrigger = document.getElementsByClassName('modal_overlay');

      /* Set onclick event handler for all trigger elements */
      for(var i = 0; i < modalTrigger.length; i++) {
          modalTrigger[i].style.visibility = "hidden";
      }
  }
  </script>
{% endblock %}

{% block contents %}
<!-- modal, for long running bokeh code -->
<div class="modal_overlay" style="visibility: hidden; position: fixed; height: 100%; width: 100%; top: 0; left: 0; right: 0; bottom: 0; background-color: #8888aa88; z-index: 2; text-align: center; font-size: 32px; font-family: sans-serif; padding-top: 200px;">
    <b>Thinking...</b>
</div>
<!-- end modal -->

<div id="plot_div" style="border: 0px solid">
    <!-- add tabIndex="-1" to the div if we need to make it key-listenable -->
<!-- I'm a little teapot. -->
    {{ super() }}
</div>
<script type="text/javascript">
    // $("#plot_div").keydown(function(event) {
    // document.getElementById("plot_div").addEventListener("keydown", function(event){
    // doing whole document.  Or we could figure out how to target a bokeh-generated container div
    // preventDefault causes the key not to pass to any widgets that are in focus, such as a text input
    document.addEventListener("keydown", function(event){
        // var tabs = Bokeh.documents[0].get_model_by_name('tabs');
        switch(event.keyCode){
        case 65:
            $.ajax('/handle_key?key=a');
            break;
        case 66:
            $.ajax('/handle_key?key=b');
            break;
        //case 65:
        //  tabs.active = 0;
        //  event.preventDefault()
        //  break;
        //case 66:
        //  tabs.active = 1;
        //  event.preventDefault()
        //  break;
        }
     });
</script>
{% endblock %}
